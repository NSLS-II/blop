[workspace]
authors = ["jessica-moylan <jessicamoylan10@gmail.com>", "Thomas Hopkins <thopkins1@bnl.gov>"]
channels = ["https://repo.prefix.dev/emscripten-forge-dev", "https://repo.prefix.dev/conda-forge", "conda-forge", "pytorch"]
name = "blop"
platforms = ["linux-64", "emscripten-wasm32"]
version = "0.7.5"

[dependencies]
python = ">=3.10.0,<3.13"
botorch = ">=0.14.0,<0.15"
python-tsp = ">=0.5.0,<0.6"
ax-platform = ">=1.0.0,<2"
bluesky-base = ">=1.14.4,<2"
databroker = ">=1.2.0,<1.3"
ophyd = ">=1.11.0,<2"
tiled = ">=0.1.0b30,<0.1.0b34"
gpytorch = ">=1.14,<2"
numpy = ">=2.3.3,<3"
scipy = ">=1.16.2,<2"
pytorch = ">=2.8.0,<3"
matplotlib-base = ">=3.10.6,<4"
pyqt = ">=5.15.11,<6"

[feature.dev]
platforms = ["linux-64"]

[feature.dev.dependencies]
pytest = "*"
h5py = ">=3.14.0,<4"
area-detector-handlers = ">=0.0.10,<0.0.11"
ipykernel = ">=6.30.1,<7"
xrt = ">=1.6.1,<2"
ruff = ">=0.13.2,<0.14"
nbstripout = ">=0.8.1,<0.9"
pre-commit = ">=4.3.0,<5"
ipython = ">=9.6.0,<10"
pandas-stubs = ">=2.3.2.250926,<3"
pyright = ">=1.1.406,<2"
xeus-python = "*"
ipympl = ">=0.9"
jupytext = ">=1.16"
jupyterlab = ">=4.4.9,<5"
jupyterlite-core = ">=0.6.4,<0.7"
notebook = ">=7.4.7,<8"
jupyterlab-myst = ">=2.4.2,<3"
jupyterlite-xeus = ">=4.2.2,<5"

[feature.dev.pypi-dependencies]
blop = { path = ".", editable = true }

[feature.dev.tasks]
build-docs = "make -C docs/ html"
test-tutorials = "bash docs/test.sh"
convert-tutorials = { cmd = "bash docs/convert_all_jupyterlite.sh", inputs = ["docs/source/tutorials"], outputs = ["docs/build/ipynbs"] }
setup-jupyter-env = { cmd = "pixi install -e jupyter", inputs = ["pixi.lock"] }

[feature.dev.tasks.build-tutorials]
cmd = "jupyter lite build --XeusAddon.prefix=.pixi/envs/dev --contents docs/build/ipynbs --output-dir docs/build/html/jupyterlite --settings-overrides=.binder/overrides.json --log-level DEBUG"
depends-on = ["setup-jupyter-env", "convert-tutorials"]
inputs = ["pixi.lock", "docs/source/tutorials"]
outputs = ["docs/build/html/jupyterlite"]

[feature.dev.tasks.serve-tutorials]
cmd = "python -m http.server 8000 -d docs/build/html/jupyterlite/"
depends-on = ["build-tutorials"]

[feature.dev.activation]
# Workaround overrides JupyterLab configuration (at the environment level) to
# make double-clicking on a Jupytext Markdown file open that file as a
# notebook. This is important for the development workflow for contributors.
scripts = ["docs/activate.sh"]

[feature.jupyter]
channels = ["https://repo.mamba.pm/emscripten-forge", "conda-forge"]
platforms = ["emscripten-wasm32"]

[feature.jupyter.dependencies]
xeus-python = "*"
python = ">=3.11"
matplotlib = ">=3.9"
ipympl = ">=0.9"
jupytext = ">=1.16"

[environments]
dev = ["dev"]
jupyter = ["jupyter"]
